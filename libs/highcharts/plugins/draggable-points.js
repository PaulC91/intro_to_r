!function(a){"object"==typeof module&&module.exports?module.exports=a:a(Highcharts)}(function(a){"use strict";function e(a,b,c){var e=b.options,f=d(e["dragMin"+c],void 0),g=d(e["dragMax"+c],void 0),h=d(e["dragPrecision"+c],void 0);return isNaN(h)||(a=Math.round(a/h)*h),a<f?a=f:a>g&&(a=g),a}var b=a.addEvent,c=a.each,d=a.pick;a.Chart.prototype.callbacks.push(function(a){function q(a){var b=a.originalEvent||a,c=b.changedTouches?b.changedTouches[0].pageX:a.pageX,g=b.changedTouches?b.changedTouches[0].pageY:a.pageY,q=f.series,r=q.options.draggableX&&f.draggableX!==!1,s=q.options.draggableY&&f.draggableY!==!1,t=d(q.options.dragSensitiviy,1),u=r?h-c:0,v=s?i-g:0,w=j-u,x=k-v,y=void 0===h?f.x:q.xAxis.toValue(w,!0),z=void 0===i?f.y:q.yAxis.toValue(x,!0);if(y=e(y,q,"X"),z=e(z,q,"Y"),f.low){var B=l-v,C=m-v;o=void 0===i?f.high:q.yAxis.toValue(B,!0),p=void 0===i?f.low:q.yAxis.toValue(C,!0),o=e(o,q,"Y"),p=e(p,q,"Y")}return Math.sqrt(Math.pow(u,2)+Math.pow(v,2))>t?{x:r?y:f.x,y:s?z:f.y,high:s&&!n?o:f.high,low:s&&n?p:f.low}:null}function r(a){var b;f&&(a&&(b=q(a),b&&(f.update(b),f.series.options.kdNow=!0,f.series.buildKDTree())),b&&(b.dragStart=g,f.firePointEvent("drop",b))),f=h=i=void 0}function s(b){var c,e,o,d=b.originalEvent||b;(d.target.getAttribute("class")||"").indexOf("highcharts-handle")!==-1&&(e=d.target.point),o=a.hoverPoint&&a.hoverPoint.series,e||!a.hoverPoint||o.useDragHandle&&o.useDragHandle()||(e=a.hoverPoint),e&&(c=e.series.options,g={},c.draggableX&&e.draggableX!==!1&&(f=e,h=d.changedTouches?d.changedTouches[0].pageX:b.pageX,j=f.plotX,g.x=f.x),c.draggableY&&e.draggableY!==!1&&(f=e,i=d.changedTouches?d.changedTouches[0].pageY:b.pageY,k=f.plotY+(a.plotHeight-(f.yBottom||a.plotHeight)),g.y=f.y,f.plotHigh&&(l=f.plotHigh,m=f.plotLow,n=Math.abs(m-(i-60))<Math.abs(l-(i-60)))),f&&(a.mouseIsDown=!1))}function t(b){if(b.preventDefault(),f){var d,c=q(b);c&&(c.dragStart=g,f.firePointEvent("drag",c,function(){var b,e=f.series;d=!0,f.update(c,!1),e.halo&&(e.halo=e.halo.destroy()),a.tooltip&&a.tooltip.refresh(a.tooltip.shared?[f]:f),e.stackKey?a.redraw():(b=e.kdTree,e.redraw(),e.kdTree=b)}),d||r())}}var f,g,h,i,j,k,l,m,n,o,p,c=a.container;a.redraw(),b(c,"mousemove",t),b(c,"touchmove",t),b(c,"mousedown",s),b(c,"touchstart",s),b(document,"mouseup",r),b(document,"touchend",r),b(c,"mouseleave",r)}),a.seriesTypes.column.prototype.useDragHandle=function(){var a=this.chart.is3d&&this.chart.is3d();return!a},a.seriesTypes.column.prototype.dragHandlePath=function(a,b){var c=a.x,d=a.y,e=a.x+a.width;return["M",c,d+6*b,"L",c,d,"L",e,d,"L",e,d+2*b,"L",c,d+2*b,"L",e,d+2*b,"L",e,d+4*b,"L",c,d+4*b,"L",e,d+4*b,"L",e,d+6*b]},a.wrap(a.seriesTypes.column.prototype,"drawTracker",function(a){var b=this,d=b.options,e=b.borderWidth||0;a.apply(b),this.useDragHandle()&&(d.draggableX||d.draggableY)&&c(b.points,function(a){var c=(d.dragHandlePath||b.dragHandlePath)(a.shapeArgs,e);a.handle?a.handle.attr({d:c}):(a.handle=b.chart.renderer.path(c).attr({fill:d.dragHandleFill||"rgba(0,0,0,0.5)",class:"highcharts-handle","stroke-width":e,stroke:d.dragHandleStroke||d.borderColor||1}).css({cursor:"ns-resize"}).add(b.group),a.handle.element.point=a)})})});