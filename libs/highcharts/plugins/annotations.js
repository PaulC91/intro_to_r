!function(a){"object"==typeof module&&module.exports?module.exports=a:a(Highcharts)}(function(a){"use strict";function m(a){var b,c;return c={xAxis:0,yAxis:0,shape:{params:{stroke:"#000000",fill:"rgba(0,0,0,0)","stroke-width":2}},selectionMarker:{"stroke-width":1,stroke:"black",fill:"transparent",dashstyle:"ShortDash","shape-rendering":"crispEdges"}},b={circle:{params:{x:0,y:0}}},b[a]&&(c.shape=f(c.shape,b[a])),c}function n(){var a=[],b=["circle","line","square","text"],c=["circle","path","rect",null],d=[{r:0,fill:"rgba(255,0,0,0.4)",stroke:"black"},{d:["M",0,0,"L",10,10],fill:"rgba(255,0,0,0.4)",stroke:"black"},{width:10,height:10,fill:"rgba(255,0,0,0.4)",stroke:"black"}],e=[l.getRadius,l.getPath,l.getRect,l.getText],f=[l.getRadiusAndUpdate,l.getPathAndUpdate,l.getRectAndUpdate,l.showInput];return g(b,function(b,g){a.push({annotationEvents:{step:e[g],stop:f[g]},annotation:{anchorX:"left",anchorY:"top",xAxis:0,yAxis:0,shape:{type:c[g],params:d[g]}},symbol:{shape:b,size:12,style:{"stroke-width":2,stroke:"black",fill:"red",zIndex:121}},style:{fill:"black",stroke:"blue",strokeWidth:2},size:12,states:{selected:{fill:"#9BD"},hover:{fill:"#9BD"}}})}),{enabledButtons:!0,buttons:a,buttonsOffsets:[0,0]}}function o(a){return"[object Array]"===Object.prototype.toString.call(a)}function p(a){return"number"==typeof a}function q(a){return a!==b&&null!==a}function r(a,b,c,d,e){for(var f=a.length,g=0,h=[];g<f;)"number"==typeof a[g]&&"number"==typeof a[g+1]?(h[g]=b.toPixels(a[g])-d,h[g+1]=c.toPixels(a[g+1])-e,g+=2):(h[g]=a[g],g+=1);return h}function s(a,b,c){var d=a.renderer.g("annotations-group-"+b);return d.attr({zIndex:7}),d.add(),d.clip(c),d}function t(a,b){var c={x:b.left,y:b.top,width:b.width,height:b.height};return a.renderer.clipRect(c)}function u(a){function b(b){var c=a.annotations.selected;a.annotations.options.buttons[c].annotationEvents.step.call(a.drawAnnotation,b)}function c(c){var d=a.container.getBoundingClientRect(),e=c.clientX-d.left,g=c.clientY-d.top;if(a.isInsidePlot(e-a.plotLeft,g-a.plotTop)&&!a.annotations.allowZoom){var h=a.xAxis[0],j=a.yAxis[0],k=a.annotations.selected,l=f(a.annotations.options.buttons[k].annotation,{xValue:h.toValue(e),yValue:j.toValue(g),allowDragX:!0,allowDragY:!0});a.addAnnotation(l),a.drawAnnotation=a.annotations.allItems[a.annotations.allItems.length-1],i(document,"mousemove",b)}}function d(c){if(j(document,"mousemove",b),a.drawAnnotation){var d=a.annotations.selected;a.annotations.options.buttons[d].annotationEvents.stop.call(a.drawAnnotation,c)}a.drawAnnotation=null}i(a.container,"mousedown",c),i(document,"mouseup",d)}function v(a,b){return function(){var c=b.annotations.buttons[a][0];2===c.state?(b.annotations.selected=-1,b.annotations.allowZoom=!0,c.setState(0)):(b.annotations.selected>=0&&b.annotations.buttons[b.annotations.selected][0].setState(0),b.annotations.allowZoom=!1,b.annotations.selected=a,c.setState(2))}}function w(a,b,c){var q,r,d=a.annotations.options.buttonsOffsets,e=a.rangeSelector&&a.rangeSelector.inputGroup?a.rangeSelector.inputGroup.offset:0,f=a.renderer,g=b.symbol,h=30,i=g.size,j=4,k=b.size-j,l=a.plotWidth+a.plotLeft-(c+1)*h-e-d[0],m=a.plotTop-(a.rangeSelector?23+k+j:0)+d[1],n=b.events&&b.events.click?b.events.click:v(c,a),o=b.states.selected,p=b.states.hover;return q=f.button("",l,m,n,{},p,o).attr({width:k,height:k,zIndex:10}),r=f.symbol(g.shape,k-i/2+j,k-i/2+j,i,i).attr(g.style).add(q),q.attr(q.style).add(),[q,r]}function x(a){var b=a.annotations.options.buttons;a.annotations.buttons=a.annotations.buttons||[],g(b,function(b,c){a.annotations.buttons.push(w(a,b,c))})}var b,c,d=a.Chart,e=a.extend,f=a.merge,g=a.each,h=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||a.inArray,i=a.addEvent,j=a.removeEvent,k=!!a.VMLRenderer;a.ALLOWED_SHAPES=["path","rect","circle"],c={top:0,left:0,center:.5,middle:.5,bottom:1,right:1},a.SVGRenderer.prototype.symbols.line=function(a,b,c,d){var e=2;return["M",a+e,b+e,"L",a+c-e,b+d-e]},a.SVGRenderer.prototype.symbols.text=function(a,b,c,d){var e=1;return["M",a,b+e,"L",a+c,b+e,"M",a+c/2,b+e,"L",a+c/2,b+e+d]},a.VMLRenderer&&(a.VMLRenderer.prototype.symbols.text=a.SVGRenderer.prototype.symbols.text,a.VMLRenderer.prototype.symbols.line=a.SVGRenderer.prototype.symbols.line),a.wrap(a.Pointer.prototype,"drag",function(a,b){this.chart.annotations&&!this.chart.annotations.allowZoom||a.call(this,b)}),a.wrap(a.Pointer.prototype,"onContainerMouseDown",function(a,b){a.call(this,b),this.chart.selectedAnnotation&&this.chart.selectedAnnotation.events.deselect.call(this.chart.selectedAnnotation,b)});var l={getRadius:function(a){var b=this,c=b.chart,d=c.container.getBoundingClientRect(),e=a.clientX-d.left,f=a.clientY-d.top,g=c.xAxis[b.options.xAxis],h=c.yAxis[b.options.yAxis],i=Math.abs(e-g.toPixels(b.options.xValue)),j=Math.abs(f-h.toPixels(b.options.yValue)),k=parseInt(Math.sqrt(i*i+j*j),10);return b.shape.attr({r:k}),k},getRadiusAndUpdate:function(a){var b=l.getRadius.call(this,a);this.update({shape:{params:{r:b,x:-b,y:-b}}})},getPath:function(a){var b=this,c=b.chart,d=c.container.getBoundingClientRect(),e=a.clientX-d.left,f=a.clientY-d.top,g=c.xAxis[b.options.xAxis],h=c.yAxis[b.options.yAxis],i=e-g.toPixels(b.options.xValue),j=f-h.toPixels(b.options.yValue),k=["M",0,0,"L",parseInt(i,10),parseInt(j,10)];return b.shape.attr({d:k}),k},getPathAndUpdate:function(a){var b=this,c=b.chart,d=l.getPath.call(b,a),e=c.xAxis[b.options.xAxis],f=c.yAxis[b.options.yAxis],g=e.toValue(d[4]+e.toPixels(b.options.xValue)),h=f.toValue(d[5]+f.toPixels(b.options.yValue));this.update({xValueEnd:g,yValueEnd:h,shape:{params:{d:d}}})},getRect:function(a){var b=this,c=b.chart,d=c.container.getBoundingClientRect(),e=a.clientX-d.left,f=a.clientY-d.top,g=c.xAxis[b.options.xAxis],h=c.yAxis[b.options.yAxis],i=g.toPixels(b.options.xValue),j=h.toPixels(b.options.yValue),k=e-i,l=f-j,m=Math.round(k)+1,n=Math.round(l)+1,o={};return o.x=m<0?m:0,o.width=Math.abs(m),o.y=n<0?n:0,o.height=Math.abs(n),b.shape.attr({x:o.x,y:o.y,width:o.width,height:o.height}),o},getRectAndUpdate:function(a){var b=l.getRect.call(this,a);this.update({shape:{params:b}})},getText:function(){},showInput:function(a){var f,b=this,c=b.chart,d=c.annotationInputIndex=c.annotationInputIndex?c.annotationInputIndex:1,e=document.createElement("span");e.innerHTML='<input type="text" class="annotation-'+d+'" placeholder="Add text"><button class=""> Done </button>',e.style.position="absolute",e.style.left=a.pageX+"px",e.style.top=a.pageY+"px",document.body.appendChild(e),e.querySelectorAll("input")[0].focus(),f=e.querySelectorAll("button")[0],f.onclick=function(){var a=this.parentNode;b.update({title:{text:a.querySelectorAll("input")[0].value}}),a.parentNode.removeChild(a)},c.annotationInputIndex++}},y=function(){this.init.apply(this,arguments)};y.prototype={init:function(a,b){var c=b.shape&&b.shape.type;this.chart=a,this.options=f({},m(c),b),this.userOptions=b},render:function(b){function r(a,b){if(q(b))for(var d in b)!function(d){i(a.element,d,function(a){b[d].call(c,a)})}(d)}var c=this,d=this.chart,e=c.chart.renderer,f=c.group,g=c.title,j=c.shape,k=c.options,l=k.title,m=k.shape,n=k.allowDragX,o=k.allowDragY,p=c.hasEvents;f||(f=c.group=e.g(),f.attr({class:"highcharts-annotation"})),!j&&m&&h(m.type,a.ALLOWED_SHAPES)!==-1&&(j=c.shape="rect"===m.type?e[k.shape.type]().attr(m.params):e[k.shape.type](m.params),j.add(f)),!g&&l&&(g=c.title=e.label(l),g.add(f)),!n&&!o||p?p||($(f.element).on("mousedown",function(a){c.events.select(a,c)}),r(f,k.events)):($(f.element).on("mousedown",function(a){c.events.storeAnnotation(a,c,d),c.events.select(a,c)}),i(document,"mouseup",function(a){c.events.releaseAnnotation(a,d)}),r(f,k.events)),this.hasEvents=!0,f.add(d.annotations.groups[k.yAxis]),c.linkObjects(),b!==!1&&c.redraw()},redraw:function(b){var u,v,w,x,y,z,d=this.options,f=this.chart,g=this.group,h=this.title,i=this.shape,j=this.linkedObject,l=f.xAxis[d.xAxis],m=f.yAxis[d.yAxis],n=d.width,o=d.height,s=c[d.anchorY],t=c[d.anchorX];if(j&&(v=j instanceof a.Point?"point":j instanceof a.Series?"series":null,"point"===v?(d.x=j.plotX+f.plotLeft,d.y=j.plotY+f.plotTop,w=j.series):"series"===v&&(w=j),w.pointXOffset&&(d.x+=w.pointXOffset+(j.shapeArgs.width/2||0)),g.attr({visibility:w.group.attr("visibility")})),y=q(d.xValue)?l.toPixels(d.xValue):d.x,z=q(d.yValue)?m.toPixels(d.yValue):d.y,f.inverted&&q(d.xValue)&&q(d.yValue)){var A=y;y=z,z=A}if(!isNaN(y)&&!isNaN(z)&&p(y)&&p(z)){if(h){var B=d.title;k?h.attr({text:B.text}):h.attr(B),h.css(d.title.style)}if(i){if(u=e({},d.shape.params),"values"===d.shape.units){var C=f.inverted?m:l,D=f.inverted?l:m;q(u.x)&&u.width?(u.width=l.toPixels(u.width+u.x)-l.toPixels(u.x),u.x=l.toPixels(u.x)):u.width?u.width=C.toPixels(u.width)-C.toPixels(0):q(u.x)&&(u.x=l.toPixels(u.x)),q(u.y)&&u.height?(u.height=-m.toPixels(u.height+u.y)+m.toPixels(u.y),u.y=m.toPixels(u.y)):u.height?(u.height=-D.toPixels(u.height)+D.toPixels(0),u.height*=f.inverted?-1:1):q(u.y)&&(u.y=m.toPixels(u.y)),"path"===d.shape.type&&(u.d=r(u.d,l,m,y,z))}q(d.yValueEnd)&&q(d.xValueEnd)&&(u.d=u.d||d.shape.d||["M",0,0,"L",0,0],u.d[4]=l.toPixels(d.xValueEnd)-l.toPixels(d.xValue),u.d[5]=m.toPixels(d.yValueEnd)-m.toPixels(d.yValue)),"circle"===d.shape.type&&(u.x+=u.r,u.y+=u.r),i.attr(u)}g.bBox=null,p(n)||(x=g.getBBox(),n=x.width),p(o)||(x||(x=g.getBBox()),o=x.height),p(t)||(t=c.center),p(s)||(s=c.center),y-=n*t,z-=o*s,this.selectionMarker&&this.events.select({},this),b&&f.animation&&q(g.translateX)&&q(g.translateY)?g.animate({translateX:y,translateY:z}):g.translate(y,z)}},destroy:function(){var a=this,b=this.chart,c=b.annotations.allItems,d=c.indexOf(a);b.activeAnnotation=null,d>-1&&(c.splice(d,1),b.options.annotations.splice(d,1)),g(["title","shape","group"],function(b){a[b]&&a[b].destroy?(a[b].destroy(),a[b]=null):a[b]&&(a[b].remove(),a[b]=null)}),a.group=a.title=a.shape=a.chart=a.options=a.hasEvents=null},show:function(){this.linkedObject||(this.visible=!0,this.group.attr({visibility:"visible"}))},hide:function(){this.linkedObject||(this.visible=!1,this.group.attr({visibility:"hidden"}))},update:function(a,b){var c=this,d=this.chart,e=d.annotations.allItems,g=e.indexOf(c),h=f(this.options,a);return g>=0&&(d.options.annotations[g]=h),this.options=h,this.linkObjects(),this.render(b),this},select:function(){return this.events.select(null,this),this},deselect:function(){return this.events.deselect(null,this),this.chart.selectedAnnotation=null,this},linkObjects:function(){var a=this,b=a.chart,c=a.linkedObject,d=c&&(c.id||c.options.id),e=a.options,f=e.linkedTo;q(f)?q(c)&&f===d||(a.linkedObject=b.get(f)):a.linkedObject=null},events:{select:function(a,b){var e,c=b.chart,d=c.selectedAnnotation,f=10;d&&d!==b&&d.deselect(),b.selectionMarker||(e=b.group.getBBox(),b.selectionMarker=c.renderer.rect(e.x-f/2,e.y-f/2,e.width+f,e.height+f).attr(b.options.selectionMarker),b.selectionMarker.add(b.group)),c.selectedAnnotation=b},deselect:function(){this.selectionMarker&&this.group&&(this.selectionMarker.destroy(),this.selectionMarker=!1,this.group.bBox=null)},destroyAnnotation:function(a,b){b.destroy()},translateAnnotation:function(a,b){if(a.stopPropagation(),a.preventDefault(),b.activeAnnotation){var c=b.container.getBoundingClientRect(),d=a.clientX-c.left,e=a.clientY-c.top;if(!b.isInsidePlot(d-b.plotLeft,e-b.plotTop))return;var f=b.activeAnnotation,g=f.options.allowDragX?a.clientX-f.startX+f.group.translateX:f.group.translateX,h=f.options.allowDragY?a.clientY-f.startY+f.group.translateY:f.group.translateY;f.transX=g,f.transY=h,f.group.attr({transform:"translate("+g+","+h+")"}),f.hadMove=!0}},storeAnnotation:function(a,b,c){if(c.annotationDraging||(a.stopPropagation(),a.preventDefault()),!k&&0===a.button||k&&1===a.button){var d=a.clientX,e=a.clientY;c.activeAnnotation=b,c.activeAnnotation.startX=d,c.activeAnnotation.startY=e,c.activeAnnotation.transX=0,c.activeAnnotation.transY=0,i(document,"mousemove",function(a){b.events.translateAnnotation(a,c)})}},releaseAnnotation:function(a,b){if(a.stopPropagation(),a.preventDefault(),!b.activeAnnotation||0===b.activeAnnotation.transX&&0===b.activeAnnotation.transY)b.activeAnnotation=null;else{var c=b.activeAnnotation,d=c.transX,e=c.transY,f=c.options,g=f.xValue,h=f.yValue,i=f.xValueEnd,j=f.yValueEnd,k=f.allowDragX,l=f.allowDragY,m=c.chart.xAxis[c.options.xAxis],n=c.chart.yAxis[c.options.yAxis],o=m.toValue(d),p=n.toValue(e);0===d&&0===e||(k&&l?c.update({xValue:q(g)?o:null,yValue:q(h)?p:null,xValueEnd:q(i)?i-g+o:null,yValueEnd:q(j)?j-h+p:null,x:q(g)?null:d,y:q(h)?null:e},!1):k?c.update({xValue:q(g)?o:null,yValue:q(h)?h:null,xValueEnd:q(i)?i-g+o:null,yValueEnd:q(j)?j:null,x:q(g)?null:d,y:q(h)?null:c.options.y},!1):l&&c.update({xValue:q(g)?g:null,yValue:q(h)?p:null,xValueEnd:q(i)?i:null,yValueEnd:q(j)?j-h+p:null,x:q(g)?null:c.options.x,y:q(h)?null:e},!1)),b.activeAnnotation=null,b.redraw(!1)}}}},e(d.prototype,{addAnnotation:function(a,b){var e,f,g,h,c=this,d=c.annotations.allItems;for(o(a)||(a=[a]),h=a.length,g=0;g<h;g++)e=new y(c,a[g]),f=d.push(e),f>c.options.annotations.length&&c.options.annotations.push(a[g]),e.render(b)},redrawAnnotations:function(){for(var h,i,a=this,b=a.yAxis,c=b.length,d=a.annotations,e=d.options.buttonsOffsets,f=0;f<c;f++)if(i=b[f],h=d.clipPaths[f])h.attr({x:i.left,y:i.top,width:i.width,height:i.height});else{var j=t(a,i);d.clipPaths.push(j),d.groups.push(s(a,f,j))}g(a.annotations.allItems,function(a){a.redraw()}),g(a.annotations.buttons,function(b,c){var d=a.rangeSelector&&a.rangeSelector.inputGroup?a.rangeSelector.inputGroup.offset:0,f=a.plotWidth+a.plotLeft-30*(c+1)-d-e[0];b[0].attr({x:f})})}}),d.prototype.callbacks.push(function(a){for(var j,k,b=a.options.annotations,c=a.yAxis,d=c.length,e=[],g=[],h=0;h<d;h++)j=c[h],k=t(a,j),e.push(k),g.push(s(a,h,k));a.annotations||(a.annotations={}),a.options.annotations||(a.options.annotations=[]),a.annotations.allItems||(a.annotations.allItems=[]),a.annotations.allowZoom=!0,a.annotations.chart=a,a.annotations.groups=g,a.annotations.clipPaths=e,o(b)&&b.length>0&&a.addAnnotation(a.options.annotations),a.annotations.options=f(n(),a.options.annotationsOptions?a.options.annotationsOptions:{}),a.annotations.options.enabledButtons?(x(a),u(a)):a.annotations.buttons=[],i(a,"redraw",function(){a.redrawAnnotations()})}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1})});