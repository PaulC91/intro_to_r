!function(a){function b(a){var b=[0,0,0,0,0,0],c=0,d=[];for(i=a.length;c<i;c++)null!=a[c].x&&(a[c][0]=a[c].x,a[c][1]=a[c].y),null!=a[c][1]&&(b[0]+=a[c][0],b[1]+=a[c][1],b[2]+=a[c][0]*a[c][0]*a[c][1],b[3]+=a[c][1]*Math.log(a[c][1]),b[4]+=a[c][0]*a[c][1]*Math.log(a[c][1]),b[5]+=a[c][0]*a[c][1]);for(var e=b[1]*b[2]-b[5]*b[5],f=Math.pow(Math.E,(b[2]*b[3]-b[5]*b[4])/e),g=(b[1]*b[4]-b[5]*b[3])/e,h=0,i=a.length;h<i;h++){var j=[a[h][0],f*Math.pow(Math.E,g*a[h][0])];d.push(j)}d.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0});var k="y = "+Math.round(100*f)/100+"e^("+Math.round(100*g)/100+"x)";return{equation:[f,g],points:d,string:k}}function c(a,b){for(var c=[0,0,0,0,0],d=0,e=[],f=a.length;d<a.length;d++)null!=a[d].x&&(a[d][0]=a[d].x,a[d][1]=a[d].y),null!=a[d][1]?(c[0]+=a[d][0],c[1]+=a[d][1],c[2]+=a[d][0]*a[d][0],c[3]+=a[d][0]*a[d][1],c[4]+=a[d][1]*a[d][1]):f-=1;for(var g=(f*c[3]-c[0]*c[1])/(f*c[2]-c[0]*c[0]),h=c[1]/f-g*c[0]/f,i=0,j=a.length;i<j;i++){var k=a[i][0]*g+h;b&&(k=parseFloat(k.toFixed(b)));var l=[a[i][0],k];e.push(l)}e.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0});var m="y = "+Math.round(100*g)/100+"x + "+Math.round(100*h)/100;return{equation:[g,h],points:e,string:m}}function d(a){var b=[0,0,0,0],c=0,d=[];for(i=a.length;c<i;c++)null!=a[c].x&&(a[c][0]=a[c].x,a[c][1]=a[c].y),null!=a[c][1]&&(b[0]+=Math.log(a[c][0]),b[1]+=a[c][1]*Math.log(a[c][0]),b[2]+=a[c][1],b[3]+=Math.pow(Math.log(a[c][0]),2));for(var f=(c*b[1]-b[2]*b[0])/(c*b[3]-b[0]*b[0]),g=(b[2]-f*b[0])/c,h=0,i=a.length;h<i;h++){var j=[a[h][0],g+f*Math.log(a[h][0])];d.push(j)}d.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0});var k="y = "+Math.round(100*g)/100+" + "+Math.round(100*f)/100+" ln(x)";return{equation:[g,f],points:d,string:k}}function f(a,b,c){"undefined"==typeof b&&(b=2);for(var d=[],e=[],f=[],g=0,i=0,j=0,k=b+1;j<k;j++){for(var l=0,m=a.length;l<m;l++)null!=a[l].x&&(a[l][0]=a[l].x,a[l][1]=a[l].y),null!=a[l][1]&&(g+=Math.pow(a[l][0],j)*a[l][1]);d.push(g),g=0;for(var n=[],o=0;o<k;o++){for(var l=0,m=a.length;l<m;l++)a[l][1]&&(i+=Math.pow(a[l][0],j+o));n.push(i),i=0}e.push(n)}e.push(d);for(var p=h(e,k),q=a.length+c,r=a[a.length-1][0]-a[a.length-2][0],j=0,m=q;j<m;j++){var s=0;if("undefined"!=typeof a[j])var t=a[j][0];else var t=a[a.length-1][0]+(j-a.length)*r;for(var u=0;u<p.length;u++)s+=p[u]*Math.pow(t,u);f.push([t,s])}f.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0});for(var v="y = ",j=p.length-1;j>=0;j--)v+=j>1?Math.round(100*p[j])/100+"x^"+j+" + ":1==j?Math.round(100*p[j])/100+"x + ":Math.round(100*p[j])/100;return{equation:p,points:f,string:v}}function g(a,b){function f(a){var c,b={},d=a.length,e=[];for(c=0;c<d;c+=1)b[a[c]]=a[c];for(c in b)e.push(b[c]);return e}function g(a){var b=1-a*a*a;return b*b*b}var b=b||.25,c=a.map(function(a){return a[0]}),d=f(c);2/d.length>b&&(b=Math.min(2/d.length,1),console.warn("updated bandwith to "+b));var e=a.map(function(a){return a[1]}),h=[],i=0,j=Math.floor(b*c.length)-1;for(var k in c){var l=c[k];k>0&&j<c.length-1&&c[j+1]-c[k]<c[k]-c[i]&&(i++,j++);var m;m=c[k]-c[i]>c[j]-c[k]?i:j;for(var n=Math.abs(1/(c[m]-l)),o=0,p=0,q=0,r=0,s=0,t=i;t<=j;){var w,u=c[t],v=e[t];w=t<k?l-u:u-l;var x=g(w*n),y=u*x;o+=x,p+=y,q+=u*y,r+=v*x,s+=v*y,t++}var D,z=p/o,A=r/o,B=s/o,C=q/o;D=C==z*z?0:(B-z*A)/(C-z*z);var E=A-D*z;h[k]=D*l+E}return{equation:"",points:c.map(function(a,b){return[a,h[b]]}),string:""}}function h(a,b){var c=0,d=0,e=0,f=0,g=0,h=a.length-1,i=new Array(b);for(c=0;c<h;c++){for(f=c,d=c+1;d<h;d++)Math.abs(a[c][d])>Math.abs(a[c][f])&&(f=d);for(e=c;e<h+1;e++)g=a[e][c],a[e][c]=a[e][f],a[e][f]=g;for(d=c+1;d<h;d++)for(e=h;e>=c;e--)a[e][d]-=a[e][c]*a[c][d]/a[c][c]}for(d=h-1;d>=0;d--){for(g=0,e=d+1;e<h;e++)g+=a[e][d]*i[e];i[d]=(a[h][d]-g)/a[d][d]}return i}function j(a,b){var c=SSE=SSYY=mean=0,d=a.length;for(a.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0}),c=0;c<a.length;c++)null!=a[c][1]?mean+=a[c][1]:d--;for(mean/=d,c=0;c<a.length;c++)null!=a[c][1]&&(SSYY+=Math.pow(a[c][1]-b[c][1],2),SSE+=Math.pow(a[c][1]-mean,2));return 1-SSYY/SSE}function k(a,b){var c=0,d=a.length;for(i=0;i<a.length;i++)null!=a[i][1]?c+=Math.pow(a[i][1]-b[i][1],2):d--;return c=Math.sqrt(c/(d-2))}a.wrap(a.Chart.prototype,"init",function(a){var e=arguments[1].series,h=[],i=0;for(i=0;i<e.length;i++){var l=e[i];if(l.regression&&!l.rendered){l.regressionSettings=l.regressionSettings||{},l.regressionSettings.tooltip=l.regressionSettings.tooltip||{},l.regressionSettings.dashStyle=l.regressionSettings.dashStyle||"solid",l.regressionSettings.decimalPlaces=l.regressionSettings.decimalPlaces||2,l.regressionSettings.useAllSeries=l.regressionSettings.useAllSeries||!1;var n,m=l.regressionSettings.type||"linear",o={data:[],color:l.color,yAxis:l.yAxis,lineWidth:2,marker:{enabled:!1},isRegressionLine:!0,visible:l.regressionSettings.visible,type:l.regressionSettings.linetype||"spline",name:l.regressionSettings.name||"Equation: %eq",id:l.regressionSettings.id,color:l.regressionSettings.color||"",dashStyle:l.regressionSettings.dashStyle||"solid",showInLegend:!l.regressionSettings.hideInLegend,tooltip:{valueSuffix:l.regressionSettings.tooltip.valueSuffix||" "}},p=l.data;if(l.regressionSettings.useAllSeries)for(p=[],di=0;di<e.length;di++){var q=e[di];p=p.concat(q.data)}if("linear"==m)n=c(p,l.regressionSettings.decimalPlaces),o.type="line";else if("exponential"==m)n=b(p);else if("polynomial"==m){var r=l.regressionSettings.order||2,s=l.regressionSettings.extrapolate||0;n=f(p,r,s)}else if("logarithmic"==m)n=d(p);else{if("loess"!=m){console.error("Invalid regression type: ",m);break}var t=l.regressionSettings.loessSmooth||25;n=g(p,t/100)}n.rSquared=j(p,n.points),n.rValue=Math.sqrt(n.rSquared).toFixed(l.regressionSettings.decimalPlaces),n.rSquared=n.rSquared.toFixed(l.regressionSettings.decimalPlaces),n.standardError=k(p,n.points).toFixed(l.regressionSettings.decimalPlaces),o.data=n.points,o.name=o.name.replace("%r2",n.rSquared),o.name=o.name.replace("%r",n.rValue),o.name=o.name.replace("%eq",n.string),o.name=o.name.replace("%se",n.standardError),0==o.visible&&(o.visible=!1),o.regressionOutputs=n,h.push(o),arguments[1].series[i].rendered=!0}}arguments[1].series=e.concat(h),a.apply(this,Array.prototype.slice.call(arguments,1))})}(Highcharts);